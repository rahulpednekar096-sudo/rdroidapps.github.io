<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Word (DOCX) → PDF — RDroid Apps</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <!-- SEO Meta Tags -->
  <meta name="description"
    content="Convert Word (DOCX) files to PDF instantly using RDroidApps Pro. Fully offline, secure, browser-based Word to PDF converter with page size, margins, and orientation options.">

  <meta name="keywords"
    content="Word to PDF, DOCX to PDF, online Word to PDF converter, offline Word to PDF, RDroidApps tools, free PDF tools, document converter, Word PDF Pro">

  <link rel="stylesheet" href="../../css/style.css">

  <!-- docx parser -->
  <script src="https://cdn.jsdelivr.net/npm/docx-preview@1.4.0/dist/docx-preview.min.js"></script>

  <!-- jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <!-- Include jQuery for load function -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<body>
  <!-- HEADER (loaded from external file) -->
  <div id="header-container"></div>

  <!-- TOOLS QUICK LINKS (loaded from external file) -->
  <div id="tools-links-container"></div>

  <!-- MENU DRAWER (loaded from external file) -->
  <div id="menu-drawer-container"></div>

  <!-- Load all components -->
  <script>
    $(function () {
      $("#header-container").load("../../components/header.html");
      $("#menu-drawer-container").load("../../components/menu-drawer.html");
      $("#tools-links-container").load("../../components/pdf-tools-quick-links.html");
      $("#footer-container").load("../../components/footer.html");
    });
  </script>
  <section class="section">

    <h1>Word (DOCX) → PDF</h1>
    <p class="lead">Upload a Word DOCX file and convert it to PDF. Fully client-side, safe & fast.</p>

    <div class="drop" id="dropArea">
      Drop DOCX here or <button class="btn" id="pickBtn">Choose file</button>
      <input type="file" id="fileInput" accept=".docx" style="display:none">
    </div>

    <div class="controls" style="margin-top:10px">
      <label>Page size</label>
      <select id="pageSize">
        <option value="A4">A4</option>
        <option value="Letter">Letter</option>
      </select>

      <label>Orientation</label>
      <select id="orientation">
        <option value="p">Portrait</option>
        <option value="l">Landscape</option>
      </select>

      <label>Margins (mm)</label>
      <input type="number" id="margin" value="10">
    </div>

    <button class="btn btn-primary" id="convertBtn" style="margin-top:12px">Convert Word to PDF</button>

    <div class="progress" id="progressWrap">
      <div class="bar" id="progressBar"></div>
    </div>

    <h3 style="margin-top:20px">Preview</h3>
    <div id="preview" class="preview"></div>

    <pre id="log" class="log">Ready.</pre>

    <div id="download"></div>
    <section class="seo-content">
      <h2>Word to PDF Converter — RDroidApps Pro</h2>

      <p>
        Convert Microsoft Word documents (DOCX) into high-quality PDF files using
        RDroidApps Pro. The entire conversion happens inside your browser, keeping
        your documents secure and private.
      </p>

      <h2>Key Features</h2>
      <ul>
        <li>DOCX to PDF conversion</li>
        <li>Page size, margins & orientation control</li>
        <li>Live document preview</li>
        <li>Offline & privacy-safe processing</li>
      </ul>
    </section>

  </section>
  <!-- FOOTER (loaded from external file) -->
  <div id="footer-container"></div>
  <script>
    // Drawer toggle
    function toggleMenu() {
      document.getElementById("drawer").classList.toggle("open");
    }
    const pickBtn = document.getElementById("pickBtn");
    const fileInput = document.getElementById("fileInput");
    const dropArea = document.getElementById("dropArea");
    const preview = document.getElementById("preview");
    const logEl = document.getElementById("log");
    const progressWrap = document.getElementById("progressWrap");
    const progressBar = document.getElementById("progressBar");
    const download = document.getElementById("download");
    let currentFile = null;

    function log(msg) { logEl.textContent += "\n" + msg; logEl.scrollTop = logEl.scrollHeight; }
    function clear() { preview.innerHTML = ""; download.innerHTML = ""; logEl.textContent = "Ready."; }
    function setProgress(p) { progressWrap.style.display = p >= 0 ? "block" : "none"; progressBar.style.width = (p * 100) + "%"; }

    pickBtn.onclick = () => fileInput.click();
    fileInput.onchange = e => loadDocx(e.target.files[0]);

    dropArea.ondragover = e => { e.preventDefault(); dropArea.style.borderColor = "#0aa37f"; }
    dropArea.ondragleave = () => dropArea.style.borderColor = "#222";
    dropArea.ondrop = e => {
      e.preventDefault(); dropArea.style.borderColor = "#222";
      loadDocx(e.dataTransfer.files[0]);
    };

    async function loadDocx(file) {
      if (!file) return;
      clear();
      log("Loading DOCX...");

      currentFile = file;
      preview.innerHTML = "Rendering preview...";
      docx.renderAsync(file, preview);
      log("Preview ready.");
    }

    document.getElementById("convertBtn").onclick = async () => {
      if (!currentFile) { alert("Select a DOCX file first"); return; }

      log("Converting to PDF...");
      setProgress(0);

      const text = preview.innerText;
      const lines = text.split("\n");

      const { jsPDF } = window.jspdf;
      const size = document.getElementById("pageSize").value === "A4" ? "a4" : "letter";
      const orientation = document.getElementById("orientation").value === "p" ? "portrait" : "landscape";
      const margin = parseFloat(document.getElementById("margin").value) || 10;
      const pdf = new jsPDF({ unit: "mm", format: size, orientation });
      let y = margin;

      pdf.setFontSize(12);

      for (let i = 0; i < lines.length; i++) {
        const wrapped = pdf.splitTextToSize(lines[i], pdf.internal.pageSize.getWidth() - margin * 2);
        wrapped.forEach(line => {
          if (y > pdf.internal.pageSize.getHeight() - margin) {
            pdf.addPage(); y = margin;
          }
          pdf.text(margin, y, line);
          y += 6;
        });
        setProgress((i + 1) / lines.length);
        await new Promise(r => setTimeout(r, 5));
      }

      log("Building PDF...");
      const blob = pdf.output("blob");
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "converted.pdf";
      a.textContent = "Download PDF";
      a.className = "btn-primary";
      download.appendChild(a);

      log("Done.");
      setProgress(-1);
    };
  </script>
</body>

</html>
