<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>PDF â†’ Word (DOCX) â€” RDroid Apps</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="description"
    content="Extract text from PDF and convert into a DOCX Word file. Supports OCR + page-wise formatting.">
  <meta name="keywords"
    content="pdf to word, pdf to docx, convert pdf to word, pdf text extractor, ocr pdf, scanned pdf to word, pdf conversion, pdf tools, rdroid apps">

  <link rel="stylesheet" href="../../css/style.css">

  <!-- pdf.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>

  <!-- docx library -->
  <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>

  <!-- OCR (optional) -->
  <script src="https://unpkg.com/tesseract.js@v4.1.1/dist/tesseract.min.js"></script>

  <!-- Include jQuery for load function -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<body>
  <!-- HEADER (loaded from external file) -->
  <div id="header-container"></div>

  <!-- TOOLS QUICK LINKS (loaded from external file) -->
  <div id="tools-links-container"></div>

  <!-- MENU DRAWER (loaded from external file) -->
  <div id="menu-drawer-container"></div>

  <!-- Load all components -->
  <script>
    $(function () {
      $("#header-container").load("../../components/header.html");
      $("#menu-drawer-container").load("../../components/menu-drawer.html");
      $("#tools-links-container").load("../../components/pdf-tools-quick-links.html");
      $("#footer-container").load("../../components/footer.html");
    });
  </script>
  <section class="section">
    <h1>PDF â†’ Word (DOCX)</h1>
    <p class="lead">Extract text from PDF and convert into a DOCX Word file. Supports OCR + page-wise formatting.</p>

    <div class="drop" id="dropArea">
      Drop PDF here or <button class="btn" id="pickBtn">Choose file</button>
      <input type="file" id="fileInput" accept="application/pdf" style="display:none">
    </div>

    <label><input type="checkbox" id="enableOCR"> Enable OCR (slower, better accuracy)</label>

    <div style="margin-top:10px;display:flex;gap:10px">
      <button class="btn btn-primary" id="convertBtn">Convert PDF to Word</button>
      <button class="btn" id="clearBtn">Clear</button>
    </div>
    <div id="download"></div>

    <div class="progress" id="progressWrap">
      <div class="bar" id="progressBar"></div>
    </div>

    <div id="thumbs" class="thumbs"></div>
    <pre id="log" class="log">Ready.</pre>
    
    <!-- SEO Content -->
    <div id="warning" style="color:#ffb199; margin-top:8px"></div>
    <hr style="margin:32px 0">

    <section class="seo-content">
      <h2>PDF to Word Converter â€” RDroidApps Pro</h2>

      <p>
        Looking to convert your PDF documents into editable Word files? Our PDF to Word converter makes it easy to
        extract text from any PDF and save it as a DOCX file. Whether you have standard PDFs or scanned documents,
        our tool supports optional OCR (Optical Character Recognition) to ensure accurate text extraction.
      </p>
      <h3>Key Features:</h3>
      <ul>
        <li><strong>Seamless Conversion:</strong> Convert your PDF files into Word documents with just a few clicks,
          preserving the original layout and formatting.</li>
        <li><strong>OCR Support:</strong> Enable OCR to extract text from scanned PDFs and images, ensuring you get
          editable text even from non-digital sources.</li>
        <li><strong>User-Friendly Interface:</strong> Our intuitive drag-and-drop interface makes it easy to upload your
          PDFs and start the conversion process quickly.</li>
        <li><strong>Privacy Focused:</strong> All conversions are done locally in your browser, ensuring your documents
          remain private and secure.</li>
      </ul>
      <h3>How to Use the PDF to Word Converter:</h3>
      <ol>
        <li><strong>Upload Your PDF:</strong> Click on the "Choose file" button or drag and drop your PDF document into
          the designated area.</li>
        <li><strong>Select OCR Option:</strong> If your PDF contains scanned images, make sure to check the "Enable OCR"
          option for accurate text extraction.</li>
        <li><strong>Convert:</strong> Click the "Convert PDF to Word" button to start the conversion process. The
          converted Word document will appear in the download area.</li>
        <li><strong>Download:</strong> Once the conversion is complete, click the download button to save your Word
          document.</li>
      </ol>
      <p>
        Experience the convenience of converting PDFs to Word documents with our easy-to-use tool. Start converting
        your PDFs today and enjoy hassle-free text extraction and editing!
      </p>


    </section>
    <!-- FOOTER (loaded from external file) -->
    <div id="footer-container"></div>

    <script>
      // Drawer toggle
      function toggleMenu() {
        document.getElementById("drawer").classList.toggle("open");
      }
      const pickBtn = document.getElementById("pickBtn");
      const fileInput = document.getElementById("fileInput");
      const dropArea = document.getElementById("dropArea");
      const convertBtn = document.getElementById("convertBtn");
      const logEl = document.getElementById("log");
      const thumbs = document.getElementById("thumbs");
      const progressWrap = document.getElementById("progressWrap");
      const progressBar = document.getElementById("progressBar");
      const download = document.getElementById("download");
      const enableOCR = document.getElementById("enableOCR");
      let currentPDF = null;
      let docxLib = null; // We'll store the docx library here

      /* Utility */
      function log(msg) { logEl.textContent += "\n" + msg; logEl.scrollTop = logEl.scrollHeight; }
      function clear() { logEl.textContent = "Ready."; thumbs.innerHTML = ""; download.innerHTML = ""; currentPDF = null; }
      function setProgress(p) { progressWrap.style.display = p >= 0 ? "block" : "none"; progressBar.style.width = (p * 100) + "%"; }

      /* File select */
      pickBtn.onclick = () => fileInput.click();
      fileInput.onchange = e => loadPDF(e.target.files[0]);

      dropArea.ondragover = e => { e.preventDefault(); dropArea.style.borderColor = "#0aa37f"; }
      dropArea.ondragleave = () => dropArea.style.borderColor = "#222";
      dropArea.ondrop = e => {
        e.preventDefault(); dropArea.style.borderColor = "#222";
        loadPDF(e.dataTransfer.files[0]);
      };

      /* Load PDF */
      async function loadPDF(file) {
        if (!file) return;
        clear();
        log("Loading PDF...");
        const buf = await file.arrayBuffer();
        pdfjsLib.GlobalWorkerOptions.workerSrc = "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js";
        currentPDF = await pdfjsLib.getDocument({ data: buf }).promise;
        log("Pages: " + currentPDF.numPages);
        await renderThumbs();
      }

      /* Render thumbnails */
      async function renderThumbs() {
        thumbs.innerHTML = "";
        for (let i = 1; i <= currentPDF.numPages; i++) {
          const page = await currentPDF.getPage(i);
          const vp = page.getViewport({ scale: 0.25 });
          const canvas = document.createElement("canvas");
          canvas.width = vp.width; canvas.height = vp.height;
          await page.render({ canvasContext: canvas.getContext("2d"), viewport: vp }).promise;
          const img = canvas.toDataURL("image/png");
          thumbs.innerHTML += `<div class="thumb"><img src="${img}"><div style="color:#9fbfb0">Page ${i}</div></div>`;
        }
      }

      /* Load docx library dynamically */
      async function loadDocxLibrary() {
        if (!docxLib) {
          try {
            // Try to import the docx library
            docxLib = await import('https://cdn.jsdelivr.net/npm/docx@8.2.0/+esm');
            log("docx library loaded successfully");
          } catch (error) {
            log("Error loading docx library: " + error.message);
            throw error;
          }
        }
        return docxLib;
      }

      /* Convert to DOCX - Beautiful download button */
      convertBtn.onclick = async () => {
        if (!currentPDF) { alert("Select a PDF first"); return; }
        log("Extracting text...");
        setProgress(0);

        let wordContent = "";
        const doOCR = enableOCR.checked;

        for (let i = 1; i <= currentPDF.numPages; i++) {
          const page = await currentPDF.getPage(i);
          let text = "";

          if (doOCR) {
            log("OCR page " + i + "...");
            const vp = page.getViewport({ scale: 1 });
            const canvas = document.createElement("canvas");
            canvas.width = vp.width; canvas.height = vp.height;
            await page.render({ canvasContext: canvas.getContext("2d"), viewport: vp }).promise;
            const ocr = await Tesseract.recognize(canvas, "eng");
            text = ocr.data.text;
          } else {
            log("Extracting text from page " + i);
            const content = await page.getTextContent();
            text = content.items.map(item => item.str).join(" ");
          }

          wordContent += `--- Page ${i} ---\n${text}\n\n`;
          setProgress(i / currentPDF.numPages);
          await new Promise(r => setTimeout(r, 20));
        }

        log("Building DOCX file...");

        // Create a simple Word document (XML format)
        const xmlContent = `<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<?mso-application progid="Word.Document"?>
<w:wordDocument xmlns:w="http://schemas.microsoft.com/office/word/2003/wordml">
  <w:body>
    <w:p>
      <w:r>
        <w:t>${wordContent.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;').replace(/\n/g, '&#10;')}</w:t>
      </w:r>
    </w:p>
  </w:body>
</w:wordDocument>`;

        const blob = new Blob([xmlContent], { type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' });
        const url = URL.createObjectURL(blob);

        // Create nice download box with button
        download.innerHTML = `
        <div class="download-box" style="
            margin-top: 20px;
            padding: 20px;
            background: linear-gradient(135deg, #0a2a1e 0%, #083525 100%);
            border-radius: 10px;
            border: 2px solid #0aa37f;
            box-shadow: 0 4px 12px rgba(10, 163, 127, 0.2);
        ">
            <div style="display: flex; align-items: center; margin-bottom: 15px;">
                <div style="
                    width: 40px;
                    height: 40px;
                    background: #0aa37f;
                    border-radius: 50%;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    margin-right: 15px;
                    font-size: 20px;
                ">âœ“</div>
                <div>
                    <h3 style="margin: 0; color: #0aa37f; font-size: 18px;">Conversion Successful!</h3>
                    <p style="margin: 5px 0 0 0; color: #9fbfb0; font-size: 14px;">Your Word file is ready</p>
                </div>
            </div>

            <div style="
                background: rgba(10, 163, 127, 0.1);
                padding: 15px;
                border-radius: 8px;
                margin-bottom: 15px;
                border: 1px solid rgba(10, 163, 127, 0.3);
            ">
                <div style="color: #9fbfb0; font-size: 14px; margin-bottom: 5px;">File Details:</div>
                <div style="color: white; font-family: monospace; font-size: 13px;">
                    <div>File: <strong>converted.docx</strong></div>
                    <div>Pages: <strong>${currentPDF.numPages}</strong></div>
                    <div>Size: <strong>${Math.round(blob.size / 1024)} KB</strong></div>
                </div>
            </div>

            <a href="${url}" download="converted.docx" class="btn-primary" style="
                display: inline-block;
                padding: 12px 24px;
                background: linear-gradient(135deg, #0aa37f 0%, #08946e 100%);
                color: white;
                border: none;
                border-radius: 6px;
                font-size: 16px;
                font-weight: bold;
                text-decoration: none;
                cursor: pointer;
                transition: all 0.3s ease;
                box-shadow: 0 4px 8px rgba(10, 163, 127, 0.3);
            " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 12px rgba(10, 163, 127, 0.4)';"
            onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 8px rgba(10, 163, 127, 0.3)';">
                ðŸ“¥ Download Word File
            </a>

            <div style="margin-top: 10px; color: #9fbfb0; font-size: 13px;">
                Click the button above to download your converted document
            </div>
        </div>
    `;

        log("Done. Your file is ready for download.");
        setProgress(-1);

        // Clean up URL object when page is unloaded
        window.addEventListener('beforeunload', () => {
          URL.revokeObjectURL(url);
        });
      };

      document.getElementById("clearBtn").onclick = clear;
    </script>
</body>

</html>

